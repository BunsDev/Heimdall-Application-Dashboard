$.when($.ready).then(()=>{const o=(document.querySelector("base")||{}).href,c=$("form[data-item-id]").data("item-id"),r="*****";if(c){const e=$('input[name="config[password]"]').first();e.length>0&&e.attr("value",r)}$(".message-container").length&&setTimeout(()=>{$(".message-container").fadeOut()},3500);function d(e){if(e.files&&e.files[0]){const t=new FileReader;t.onload=function(a){$("#appimage img").attr("src",a.target.result)},t.readAsDataURL(e.files[0])}}$("#upload").change(function(){d(this)});const l=document.getElementById("sortable");let s;l!==null&&(s=Sortable.create(l,{disabled:!0,animation:150,forceFallback:!(navigator.userAgent.toLowerCase().indexOf("firefox")>-1),draggable:".item-container",onEnd(){const e=s.toArray();$.post(`${o}order`,{order:e})}}),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(s.option("setData",e=>{e.setData("Text","")}),l.addEventListener("dragstart",e=>{const{target:t}=e;t.nodeName.toLowerCase()==="a"&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.setData("Text",""))}))),$("#main").on("mouseenter","#sortable .item",function(){$(this).siblings(".tooltip").addClass("active"),$(".refresh",this).addClass("active")}).on("mouseleave",".item",function(){$(this).siblings(".tooltip").removeClass("active"),$(".refresh",this).removeClass("active")}),$("#config-buttons").on("mouseenter","a",function(){$(".tooltip",this).addClass("active")}).on("mouseleave","a",function(){$(".tooltip",this).removeClass("active")}),$(".searchform > form").on("submit",e=>{$("#search-container select[name=provider]").val()==="tiles"&&e.preventDefault()}),$("#search-container").on("input","input[name=q]",function(){const e=this.value,t=$("#sortable").children(".item-container");$("#search-container select[name=provider]").val()==="tiles"&&e.length>0?(t.hide(),t.filter(function(){return $(this).data("name").toLowerCase().includes(e.toLowerCase())}).show()):t.show()}).on("change","select[name=provider]",function(){const e=$("#sortable").children(".item-container");if($(this).val()==="tiles"){$("#search-container button").hide();const t=$("#search-container input[name=q]").val();t.length>0?(e.hide(),e.filter(function(){return $(this).data("name").toLowerCase().includes(t.toLowerCase())}).show()):e.show()}else $("#search-container button").show(),e.show()}),$("#app").on("click","#config-button",e=>{e.preventDefault();const t=$("#app"),a=t.hasClass("header");t.toggleClass("header"),a?($(".add-item").hide(),$(".item-edit").hide(),$("#app").removeClass("sidebar"),$("#sortable .tooltip").css("display",""),s!==void 0&&s.option("disabled",!0)):($("#sortable .tooltip").css("display","none"),s!==void 0&&s.option("disabled",!1),setTimeout(()=>{$(".add-item").fadeIn(),$(".item-edit").fadeIn()},350))}).on("click","#add-item, #pin-item",e=>{e.preventDefault(),$("#app").toggleClass("sidebar")}).on("click",".close-sidenav",e=>{e.preventDefault(),$("#app").removeClass("sidebar")}).on("click","#test_config",e=>{e.preventDefault();let t=$("#create input[name=url]").val();const a=$('#sapconfig input[name="config[override_url]"]').val();typeof a=="string"&&a!==""&&(t=a);const i={};i.url=t,$(".config-item").each(function(){const n=$(this).data("config");i[n]=$(this).val()}),i.id=$("form[data-item-id]").data("item-id"),i.password&&i.password===r&&(i.password=""),$.post(`${o}test_config`,{data:i}).done(n=>{alert(n)}).fail(n=>{alert(`Something went wrong: ${n.responseText.substring(0,100)}`)})}),$("#pinlist").on("click","a",function(e){e.preventDefault();const t=$(this),a=t.data("id"),i=t.data("tag");$.get(`${o}items/pintoggle/${a}/true/${i}`,n=>{const f=$(n).filter("#sortable").html();$("#sortable").html(f),t.toggleClass("active")})}),$("#itemform").on("submit",()=>{const e=$('input[name="config[password]"]').first();e.length>0&&e.attr("value")===r&&e.attr("value","")})});
